import java.net.UnknownHostException;

import com.mongodb.MongoClient;
import com.mongodb.MongoClientURI;
import com.mongodb.ServerAddress;

import com.mongodb.client.MongoDatabase;
import com.mongodb.client.MongoCollection;

import org.bson.Document;
import java.util.Arrays;
import com.mongodb.Block;

import com.mongodb.client.MongoCursor;
import static com.mongodb.client.model.Filters.*;
import com.mongodb.client.result.DeleteResult;
import static com.mongodb.client.model.Updates.*;
import com.mongodb.client.result.UpdateResult;
import java.util.ArrayList;
import java.util.List;
class MongoDb {
     MongoClient client = new MongoClient(new MongoClientURI("mongodb://chain:chain555@ds018538.mlab.com:18538/ox"));
     MongoDatabase db = client.getDatabase("ox");
     MongoCollection <Document> col = db.getCollection("Member");
    
     List<Document> seedData = new ArrayList<Document>();
     

     public boolean addMember(String a,String b) {
    
    	seedData.add(new Document("username",a).append("password", b));
    	Document findQuery=new Document("username",new Document("$eq",a));
    	MongoCursor<Document>  cursor = (MongoCursor<Document>) col.find(findQuery);
        try {
            while (cursor.hasNext()) {
                Document doc = cursor.next();
                if(doc.get("username").equals(a))
                	return true;
            }
        } finally {
            cursor.close();
        }
        col.insertMany(seedData);
        return false;
 
     }
     
}
